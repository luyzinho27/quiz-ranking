<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizMaster - Sistema de Quiz Educacional</title>
    <link rel="stylesheet" href="style.css">
    <!-- Firebase App (core) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <!-- Firebase Auth -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <!-- Firebase Firestore -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Ícones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Tela de Login/Cadastro -->
    <div id="auth-container" class="container">
        <div class="auth-wrapper">
            <div class="auth-header">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <h1>QuizMaster</h1>
                </div>
                <p>Teste seus conhecimentos e entre no ranking!</p>
            </div>
            
            <div class="auth-box">
                <div class="tabs">
                    <button id="login-tab" class="tab active">
                        <i class="fas fa-sign-in-alt"></i>
                        Login
                    </button>
                    <button id="register-tab" class="tab">
                        <i class="fas fa-user-plus"></i>
                        Cadastro
                    </button>
                </div>
                
                <!-- Formulário de Login -->
                <div id="login-form" class="form active">
                    <h2>Entre na sua conta</h2>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="login-email" placeholder="E-mail" required>
                    </div>
                    <div class="input-group password-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="login-password" placeholder="Senha" required>
                        <i class="toggle-password" id="toggle-login-password"></i>
                    </div>
                    <button id="login-btn" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i>
                        Entrar
                    </button>
                    <div class="auth-links">
                        <a href="#" id="forgot-password">Esqueci minha senha</a>
                    </div>
                    <p id="login-error" class="error-message"></p>
                </div>
                
                <!-- Formulário de Cadastro -->
                <div id="register-form" class="form">
                    <h2>Crie sua conta</h2>
                    <div class="input-group">
                        <i class="fas fa-user"></i>
                        <input type="text" id="register-name" placeholder="Nome completo" required>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-envelope"></i>
                        <input type="email" id="register-email" placeholder="E-mail" required>
                    </div>
                    <div class="input-group password-group">
                        <i class="fas fa-lock"></i>
                        <input type="password" id="register-password" placeholder="Senha" required>
                        <i class="toggle-password" id="toggle-register-password"></i>
                    </div>
                    <div class="input-group">
                        <i class="fas fa-users"></i>
                        <select id="register-type">
                            <option value="aluno">Aluno</option>
                            <option value="admin" id="admin-option">Administrador</option>
                        </select>
                    </div>
                    <button id="register-btn" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i>
                        Cadastrar
                    </button>
                    <p id="register-error" class="error-message"></p>
                </div>
            </div>
            
            <div class="auth-footer">
                <p>&copy; 2024 QuizMaster. Todos os direitos reservados.</p>
            </div>
        </div>
    </div>

    <!-- Dashboard do Aluno -->
    <div id="student-dashboard" class="container hidden">
        <header class="dashboard-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <h1>QuizMaster</h1>
                </div>
                <nav class="tabs">
                    <button id="quizzes-tab" class="tab active">
                        <i class="fas fa-list-alt"></i>
                        <span class="tab-text">Quizzes</span>
                    </button>
                    <button id="ranking-tab" class="tab">
                        <i class="fas fa-trophy"></i>
                        <span class="tab-text">Ranking</span>
                    </button>
                    <button id="history-tab" class="tab">
                        <i class="fas fa-history"></i>
                        <span class="tab-text">Histórico</span>
                    </button>
                </nav>
            </div>
            <div class="user-info">
                <div class="user-details">
                    <span id="student-name" class="user-name"></span>
                    <span class="user-role">Aluno</span>
                </div>
                <button id="student-logout" class="btn btn-secondary">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="btn-text">Sair</span>
                </button>
            </div>
        </header>
        
        <main class="dashboard-content">
            <!-- Lista de Quizzes -->
            <div id="quizzes-section" class="section active">
                <div class="section-header">
                    <h2>Quizzes Disponíveis</h2>
                    <p>Teste seus conhecimentos e suba no ranking!</p>
                </div>
                <div id="quizzes-list" class="cards-container"></div>
            </div>
            
            <!-- Ranking -->
            <div id="ranking-section" class="section">
                <div class="section-header">
                    <h2>Ranking Geral</h2>
                    <p>Veja os melhores colocados</p>
                </div>
                <div id="ranking-list" class="ranking-container"></div>
            </div>

            <!-- Histórico -->
            <div id="history-section" class="section">
                <div class="section-header">
                    <h2>Meu Histórico</h2>
                    <p>Veja seu desempenho nos quizzes</p>
                </div>
                <div id="history-list" class="cards-container"></div>
            </div>
        </main>
    </div>

    <!-- Dashboard do Administrador -->
    <div id="admin-dashboard" class="container hidden">
        <header class="dashboard-header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <h1>QuizMaster</h1>
                </div>
                <nav class="tabs">
                    <button id="admin-quizzes-tab" class="tab active">
                        <i class="fas fa-list-alt"></i>
                        <span class="tab-text">Gerenciar Quizzes</span>
                    </button>
                    <button id="admin-questions-tab" class="tab">
                        <i class="fas fa-question-circle"></i>
                        <span class="tab-text">Questões</span>
                    </button>
                    <button id="admin-users-tab" class="tab">
                        <i class="fas fa-users"></i>
                        <span class="tab-text">Usuários</span>
                    </button>
                    <button id="admin-reports-tab" class="tab">
                        <i class="fas fa-chart-bar"></i>
                        <span class="tab-text">Relatórios</span>
                    </button>
                </nav>
            </div>
            <div class="user-info">
                <div class="user-details">
                    <span id="admin-name" class="user-name"></span>
                    <span class="user-role">Administrador</span>
                </div>
                <button id="admin-logout" class="btn btn-secondary">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="btn-text">Sair</span>
                </button>
            </div>
        </header>
        
        <main class="dashboard-content">
            <!-- Gerenciar Quizzes -->
            <div id="admin-quizzes-section" class="section active">
                <div class="section-header">
                    <h2>Gerenciar Quizzes</h2>
                    <p>Crie e edite quizzes disponíveis para os alunos</p>
                    <button id="create-quiz-btn" class="btn btn-primary">
                        <i class="fas fa-plus"></i>
                        <span class="btn-text">Criar Novo Quiz</span>
                    </button>
                </div>
                <div id="admin-quizzes-list" class="cards-container"></div>
            </div>
            
            <!-- Gerenciar Questões -->
            <div id="admin-questions-section" class="section">
                <div class="section-header">
                    <h2>Gerenciar Questões</h2>
                    <p>Adicione e edite questões para os quizzes</p>
                    <div class="section-actions">
                        <button id="create-question-btn" class="btn btn-primary">
                            <i class="fas fa-plus"></i>
                            <span class="btn-text">Adicionar Questão</span>
                        </button>
                        <button id="import-questions-btn" class="btn btn-secondary">
                            <i class="fas fa-file-import"></i>
                            <span class="btn-text">Importar JSON</span>
                        </button>
                    </div>
                </div>
                <div id="admin-questions-list" class="cards-container"></div>
            </div>

            <!-- Gerenciar Usuários -->
            <div id="admin-users-section" class="section">
                <div class="section-header">
                    <h2>Gerenciar Usuários</h2>
                    <p>Visualize e gerencie usuários do sistema</p>
                </div>
                <div id="admin-users-list" class="cards-container"></div>
            </div>

            <!-- Relatórios -->
            <div id="admin-reports-section" class="section">
                <div class="section-header">
                    <h2>Relatórios</h2>
                    <p>Visualize estatísticas e desempenho dos alunos</p>
                </div>
                <div id="admin-reports-content" class="reports-container">
                    <!-- Conteúdo será carregado dinamicamente -->
                </div>
            </div>
        </main>
    </div>

    <!-- Tela do Quiz -->
    <div id="quiz-container" class="container hidden">
        <header class="quiz-header">
            <div class="quiz-info">
                <h1 id="quiz-title-display"></h1>
                <p id="quiz-description-display"></p>
            </div>
            <div class="quiz-controls-top">
                <button id="exit-quiz-btn" class="btn btn-secondary">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="btn-text">Sair do Quiz</span>
                </button>
                <div class="quiz-timer">
                    <div class="timer-circle">
                        <svg width="60" height="60">
                            <circle cx="30" cy="30" r="28" stroke="#e0e0e0" stroke-width="3" fill="none"></circle>
                            <circle id="timer-progress" cx="30" cy="30" r="28" stroke="#4a6cf7" stroke-width="3" fill="none" 
                                    stroke-dasharray="175" stroke-dashoffset="0" transform="rotate(-90 30 30)"></circle>
                        </svg>
                        <span id="quiz-timer">00:00</span>
                    </div>
                </div>
            </div>
        </header>
        
        <main class="quiz-content">
            <div class="quiz-progress">
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <span id="quiz-progress-text">Questão 0/0</span>
            </div>
            
            <div id="question-container" class="question-container">
                <div class="question-text-container">
                    <h2 id="question-text">Carregando questão...</h2>
                </div>
                <div id="options-container" class="options-container">
                    <div class="option" data-value="a">
                        <div class="option-content">
                            <span class="option-letter">A</span>
                            <span id="option-a-text" class="option-text">Carregando opção A...</span>
                        </div>
                    </div>
                    <div class="option" data-value="b">
                        <div class="option-content">
                            <span class="option-letter">B</span>
                            <span id="option-b-text" class="option-text">Carregando opção B...</span>
                        </div>
                    </div>
                    <div class="option" data-value="c">
                        <div class="option-content">
                            <span class="option-letter">C</span>
                            <span id="option-c-text" class="option-text">Carregando opção C...</span>
                        </div>
                    </div>
                    <div class="option" data-value="d">
                        <div class="option-content">
                            <span class="option-letter">D</span>
                            <span id="option-d-text" class="option-text">Carregando opção D...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="quiz-controls">
                <button id="prev-question" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i>
                    <span class="btn-text">Anterior</span>
                </button>
                <div class="quiz-nav">
                    <span id="current-question">1</span> de <span id="total-questions">0</span>
                </div>
                <button id="next-question" class="btn btn-primary">
                    <span class="btn-text">Próxima</span>
                    <i class="fas fa-arrow-right"></i>
                </button>
                <button id="finish-quiz" class="btn btn-success hidden">
                    <i class="fas fa-flag-checkered"></i>
                    <span class="btn-text">Finalizar Quiz</span>
                </button>
            </div>
        </main>
    </div>

    <!-- Resultado do Quiz -->
    <div id="quiz-result" class="container hidden">
        <div class="result-container">
            <div class="result-header">
                <div class="result-icon">
                    <i class="fas fa-trophy"></i>
                </div>
                <h2>Quiz Concluído!</h2>
                <p id="result-subtitle">Veja como você foi</p>
            </div>
            
            <div class="result-content">
                <div class="score-circle">
                    <div class="circle-background"></div>
                    <div class="circle-progress" id="circle-progress"></div>
                    <div class="score-text">
                        <span id="score-percentage">0%</span>
                        <span id="score-fraction">0/0</span>
                    </div>
                </div>
                
                <div class="result-details">
                    <div class="detail-item">
                        <span class="detail-label">Acertos</span>
                        <span id="correct-answers" class="detail-value correct">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Erros</span>
                        <span id="wrong-answers" class="detail-value wrong">0</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Tempo</span>
                        <span id="time-taken" class="detail-value">00:00</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Posição no Ranking</span>
                        <span id="ranking-position" class="detail-value">-</span>
                    </div>
                </div>
            </div>
            
            <div class="result-actions">
                <button id="review-quiz" class="btn btn-secondary">
                    <i class="fas fa-redo"></i>
                    <span class="btn-text">Revisar Respostas</span>
                </button>
                <button id="back-to-dashboard" class="btn btn-primary">
                    <i class="fas fa-home"></i>
                    <span class="btn-text">Voltar ao Dashboard</span>
                </button>
                <button id="new-quiz" class="btn btn-success">
                    <i class="fas fa-play"></i>
                    <span class="btn-text">Fazer Outro Quiz</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
        <p>Carregando...</p>
    </div>

    <!-- Modal para criar/editar quiz -->
    <div id="quiz-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="quiz-modal-title">Criar Novo Quiz</h3>
                <button id="close-quiz-modal" class="btn btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="quiz-title">Título do Quiz</label>
                    <input type="text" id="quiz-title" placeholder="Digite o título do quiz">
                </div>
                <div class="input-group">
                    <label for="quiz-description">Descrição</label>
                    <textarea id="quiz-description" placeholder="Digite a descrição do quiz" rows="3"></textarea>
                </div>
                <div class="input-group">
                    <label for="quiz-category">Categoria</label>
                    <select id="quiz-category">
                        <option value="">Carregando categorias...</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="quiz-questions-count">Número de Questões</label>
                    <input type="number" id="quiz-questions-count" placeholder="Número de questões" min="1" max="50">
                </div>
                <div class="input-group">
                    <label for="quiz-time">Tempo (minutos)</label>
                    <input type="number" id="quiz-time" placeholder="Tempo em minutos" min="1" max="180">
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-quiz" class="btn btn-secondary">Cancelar</button>
                <button id="save-quiz" class="btn btn-primary">Salvar Quiz</button>
            </div>
        </div>
    </div>

    <!-- Modal para criar/editar questão -->
    <div id="question-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="question-modal-title">Adicionar Nova Questão</h3>
                <button id="close-question-modal" class="btn btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="question-text">Enunciado da Questão</label>
                    <textarea id="question-text" placeholder="Digite o enunciado da questão" rows="3"></textarea>
                </div>
                <div class="input-group">
                    <label for="question-category">Categoria</label>
                    <input type="text" id="question-category" placeholder="Ex: Informática, Matemática, História">
                </div>
                <div class="options-group">
                    <label>Opções de Resposta</label>
                    <div class="input-group">
                        <span class="option-label">A)</span>
                        <input type="text" id="option-a" placeholder="Opção A">
                    </div>
                    <div class="input-group">
                        <span class="option-label">B)</span>
                        <input type="text" id="option-b" placeholder="Opção B">
                    </div>
                    <div class="input-group">
                        <span class="option-label">C)</span>
                        <input type="text" id="option-c" placeholder="Opção C">
                    </div>
                    <div class="input-group">
                        <span class="option-label">D)</span>
                        <input type="text" id="option-d" placeholder="Opção D">
                    </div>
                </div>
                <div class="input-group">
                    <label for="correct-answer">Resposta Correta</label>
                    <select id="correct-answer">
                        <option value="a">Opção A</option>
                        <option value="b">Opção B</option>
                        <option value="c">Opção C</option>
                        <option value="d">Opção D</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-question" class="btn btn-secondary">Cancelar</button>
                <button id="save-question" class="btn btn-primary">Salvar Questão</button>
            </div>
        </div>
    </div>

    <!-- Modal para importar questões -->
    <div id="import-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Importar Questões em JSON</h3>
                <button id="close-import-modal" class="btn btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="json-data">Cole o JSON com as questões</label>
                    <textarea id="json-data" placeholder='[{"text": "Pergunta?", "options": {"a": "Opção A", "b": "Opção B", "c": "Opção C", "d": "Opção D"}, "correctAnswer": "a", "category": "Geral"}]' rows="10"></textarea>
                </div>
                <div class="info-text">
                    <p><strong>Formato esperado:</strong> Array de objetos com as propriedades: text, options (objeto com a, b, c, d), correctAnswer (a, b, c ou d) e category.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-import" class="btn btn-secondary">Cancelar</button>
                <button id="import-questions" class="btn btn-primary">Importar Questões</button>
            </div>
        </div>
    </div>

    <!-- Modal para revisão de respostas -->
    <div id="review-modal" class="modal hidden">
        <div class="modal-content large">
            <div class="modal-header">
                <h3>Revisão de Respostas</h3>
                <button id="close-review-modal" class="btn btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="review-content"></div>
            </div>
            <div class="modal-footer">
                <button id="close-review" class="btn btn-primary">Fechar</button>
            </div>
        </div>
    </div>

    <!-- Modal para editar usuário -->
    <div id="user-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="user-modal-title">Editar Usuário</h3>
                <button id="close-user-modal" class="btn btn-icon">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label for="user-name">Nome</label>
                    <input type="text" id="user-name" placeholder="Nome completo">
                </div>
                <div class="input-group">
                    <label for="user-email">E-mail</label>
                    <input type="email" id="user-email" placeholder="E-mail">
                </div>
                <div class="input-group">
                    <label for="user-type">Tipo de Usuário</label>
                    <select id="user-type">
                        <option value="aluno">Aluno</option>
                        <option value="admin">Administrador</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="user-status">Status</label>
                    <select id="user-status">
                        <option value="active">Ativo</option>
                        <option value="inactive">Inativo</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button id="cancel-user" class="btn btn-secondary">Cancelar</button>
                <button id="save-user" class="btn btn-primary">Salvar Alterações</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
